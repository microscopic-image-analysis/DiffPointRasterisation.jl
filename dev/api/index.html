<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · DiffPointRasterisation</title><meta name="title" content="API · DiffPointRasterisation"/><meta property="og:title" content="API · DiffPointRasterisation"/><meta property="twitter:title" content="API · DiffPointRasterisation"/><meta name="description" content="Documentation for DiffPointRasterisation."/><meta property="og:description" content="Documentation for DiffPointRasterisation."/><meta property="twitter:description" content="Documentation for DiffPointRasterisation."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">DiffPointRasterisation</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../batch/">Batch of poses</a></li><li class="is-active"><a class="tocitem" href>API</a><ul class="internal"><li><a class="tocitem" href="#Exported-functions"><span>Exported functions</span></a></li><li><a class="tocitem" href="#Private-functions"><span>Private functions</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/microscopic-image-analysis/DiffPointRasterisation.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/microscopic-image-analysis/DiffPointRasterisation.jl/blob/main/docs/src/api.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API-Documentation"><a class="docs-heading-anchor" href="#API-Documentation">API Documentation</a><a id="API-Documentation-1"></a><a class="docs-heading-anchor-permalink" href="#API-Documentation" title="Permalink"></a></h1><h2 id="Exported-functions"><a class="docs-heading-anchor" href="#Exported-functions">Exported functions</a><a id="Exported-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Exported-functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DiffPointRasterisation.raster" href="#DiffPointRasterisation.raster"><code>DiffPointRasterisation.raster</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">raster(grid_size, points, rotation, translation, [background, out_weight])</code></pre><p>Interpolate points (multi-) linearly into an Nd-array of size <code>grid_size</code>.</p><p>Before <code>points</code> are interpolated into the array, each point <span>$p$</span> is first transformed according to</p><p class="math-container">\[\hat{p} = R p + t\]</p><p>with <code>rotation</code> <span>$R$</span> and <code>translation</code> <span>$t$</span>.</p><p>Points <span>$\hat{p}$</span> that fall into the N-dimensional hypercube with edges spanning from (-1, 1) in each dimension, are interpolated into the output array.</p><p>The total weight of each point (<code>out_weight * point_weight</code>) is distributed onto the 2^N nearest pixels/voxels of the output array (according to the closeness of the voxel center to the coordinates of point <span>$\hat{p}$</span>) via N-linear interpolation.</p><p><strong>Arguments</strong></p><ul><li><code>grid_size</code>: Tuple of integers defining the output dimensions</li><li><code>points::AbstractVector{&lt;:AbstractVector}</code>: A vector of same length vectors representing points</li><li><code>rotation</code>: Either a single matrix(-like object) or a vector of such, that linearly transform(s) <code>points</code> before rasterisation.</li><li><code>translation</code>: Either a single vector or a vector of such, that translates <code>points</code> <em>after</em> <code>rotation</code>. If <code>rotation</code> includes a projection, <code>translation</code> thus needs to have the same length as <code>rotation * points[i]</code>.</li><li><code>background</code>: Either a single number or a vector of such.</li><li><code>out_weight</code>: Either a single number or a vector (one per image) of such.</li><li><code>point_weight</code>: A vector of numbers (one per point).</li></ul><p><code>rotation</code>, <code>translation</code>, <code>background</code> and <code>out_weight</code> can have an  additional &quot;batch&quot; dimension (by providing them as vectors of single parameters. The length of these vectors must be the same for all four arguments). In this case, the output array will have dimensionality +1 with an additional axis on last position corresponding to the number of elements in the batch. See <a href="../batch/#Raster-a-single-point-cloud-to-a-batch-of-poses">Raster a single point cloud to a batch of poses</a> for more details.</p><p>See also: <a href="#DiffPointRasterisation.raster!"><code>raster!</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/microscopic-image-analysis/DiffPointRasterisation.jl/blob/80f5976d82b14e0af352e4d53ce082fab2e750e1/src/interface.jl#L1-L47">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DiffPointRasterisation.raster!" href="#DiffPointRasterisation.raster!"><code>DiffPointRasterisation.raster!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">raster!(out, points, rotation, translation, [background, out_weight, point_weight])</code></pre><p>Interpolate points (multi-) linearly into the Nd-array <code>out</code>. In-place version of <a href="#DiffPointRasterisation.raster"><code>raster</code></a>. See there for details.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/microscopic-image-analysis/DiffPointRasterisation.jl/blob/80f5976d82b14e0af352e4d53ce082fab2e750e1/src/interface.jl#L50-L55">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DiffPointRasterisation.raster_pullback!" href="#DiffPointRasterisation.raster_pullback!"><code>DiffPointRasterisation.raster_pullback!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">raster_pullback!(
    ds_dout, args...;
    [points, rotation, translation, background, out_weight, point_weight]
)</code></pre><p>Pullback for <a href="#DiffPointRasterisation.raster"><code>raster</code></a> / <a href="#DiffPointRasterisation.raster!"><code>raster!</code></a>.</p><p>Take as input <code>ds_dout</code> the sensitivity of some quantity (<code>s</code> for &quot;scalar&quot;) to the <em>output</em> <code>out</code> of the function <code>out = raster(grid_size, args...)</code> (or <code>out = raster!(out, args...)</code>), as well as the exact same arguments <code>args</code> that were passed to <code>raster</code>/<code>raster!</code>, and return the sensitivities of <code>s</code> to the <em>inputs</em> <code>args</code> of the function <code>raster</code>/<code>raster!</code>.</p><p>Optionally, pre-allocated output arrays for each input sensitivity can be specified as keyword arguments with the name of the original argument to <code>raster</code> as key, and a nd-array as value, where the n-th dimension is the batch dimension. For example to provide a pre-allocated array for the sensitivity of <code>s</code> to the <code>translation</code> argument of <code>raster</code>, do: <code>sensitivities = raster_pullback!(ds_dout, args...; translation = [zeros(2) for _ in 1:8])</code> for 2-dimensional points and a batch size of 8. See also <a href="../batch/#Raster-a-single-point-cloud-to-a-batch-of-poses">Raster a single point cloud to a batch of poses</a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/microscopic-image-analysis/DiffPointRasterisation.jl/blob/80f5976d82b14e0af352e4d53ce082fab2e750e1/src/interface.jl#L165-L189">source</a></section></article><h2 id="Private-functions"><a class="docs-heading-anchor" href="#Private-functions">Private functions</a><a id="Private-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Private-functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DiffPointRasterisation.digitstuple-Union{Tuple{N}, Tuple{Any, Val{N}}, Tuple{Any, Val{N}, Any}} where N" href="#DiffPointRasterisation.digitstuple-Union{Tuple{N}, Tuple{Any, Val{N}}, Tuple{Any, Val{N}, Any}} where N"><code>DiffPointRasterisation.digitstuple</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">digitstuple(k, Val(N))</code></pre><p>Return a N-tuple containing the bit-representation of k</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/microscopic-image-analysis/DiffPointRasterisation.jl/blob/80f5976d82b14e0af352e4d53ce082fab2e750e1/src/util.jl#L2-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DiffPointRasterisation.reference_coordinate_and_deltas-Union{Tuple{T}, Tuple{AbstractVector{T}, Any, Any, Any}} where T" href="#DiffPointRasterisation.reference_coordinate_and_deltas-Union{Tuple{T}, Tuple{AbstractVector{T}, Any, Any, Any}} where T"><code>DiffPointRasterisation.reference_coordinate_and_deltas</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">reference_coordinate_and_deltas(point, rotation, origin, scale)</code></pre><p>Return </p><ul><li>The cartesian coordinate of the voxel of an N-dimensional rectangular  grid that is the one closest to the origin, out of the 2^N voxels that are next neighbours of the (N-dimensional) <code>point</code></li><li>A Nx2 array containing coordinate-wise distances of the <code>scale</code>d <code>point</code> to the voxel that is<ul><li>closest to the origin (out of the 2^N next neighbors) in the first column</li><li>furthest from the origin (out of the 2^N next neighbors) in the second column.</li></ul></li></ul><p>The grid is implicitely assumed to discretize the hypercube ranging from (-1, 1) in each dimension. Before <code>point</code> is discretized into this grid, it is first translated by  <code>-origin</code> and then scaled by <code>scale</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/microscopic-image-analysis/DiffPointRasterisation.jl/blob/80f5976d82b14e0af352e4d53ce082fab2e750e1/src/raster.jl#L68-L84">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DiffPointRasterisation.voxel_shifts-Union{Tuple{Val{N}}, Tuple{N}, Tuple{Val{N}, Any}} where N" href="#DiffPointRasterisation.voxel_shifts-Union{Tuple{Val{N}}, Tuple{N}, Tuple{Val{N}, Any}} where N"><code>DiffPointRasterisation.voxel_shifts</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">voxel_shifts(Val(N), [int_type])</code></pre><p>Enumerate nearest neighbor coordinate shifts with respect to &quot;upper left&quot; voxel.</p><p>For a N-dimensional voxel grid, return a 2^N-tuple of N-tuples, where each element of the outer tuple is a cartesian coordinate shift from the &quot;upper left&quot; voxel.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/microscopic-image-analysis/DiffPointRasterisation.jl/blob/80f5976d82b14e0af352e4d53ce082fab2e750e1/src/util.jl#L16-L25">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../batch/">« Batch of poses</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Monday 12 August 2024 08:52">Monday 12 August 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
